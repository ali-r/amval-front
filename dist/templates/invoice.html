<div class="row">

    <!-- Search Object -->
    <div class="col-xs-12">
        <div class="x_panel">

            <div class="x_content">
                <search-tools sobject="invoice.searchObject" scontroller="invoice"></search-tools>
            </div>
        </div>
    </div>
    <!-- /Search Object-->

    <div class="col-xs-12">

        <!-- invoice list -->
        <div class="col-xs-6">
            <div class="x_panel">
                <div class="x_title">
                    <h2><i class="fa"></i>لیست فاکتورها</h2>
                    <button type="button" ng-if = "checkWrite('invoice')" class="btn btn-success btn-sm pull-left" name="button" ng-click="invoice.setNewInvoiceForm()">
                        فاکتور جدید
                    </button>
                    <div class="clearfix"></div>
                </div><!-- /.x_title-->
                <div class="x_content">
                    <table class="table table-striped jambo_table asset-tables">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>شماره فاکتور</th>
                            <th>قیمت کل</th>
                            <th></th>
                            <th></th>
                            <th ng-if = "checkWrite('invoice')"></th>
                        </tr>
                        </thead>
                        <tbody ng-hide="load">
                        <tr ng-repeat = "list in invoice.note">
                            <td>{{ (page-1)*10 + $index + 1 }}</td>
                            <td>{{list.invoice_no}}</td>
                            <td>{{list.price}}</td>
                            <td>
                                <a ng-click="invoice.getObject(list.id)" href>
                                    <i class="fa fa-lg"  ng-class = "{'fa-pencil-square-o':checkWrite('invoice') , 'fa-eye' : !checkWrite('invoice')}" aria-hidden="true"></i>
                                </a>
                            </td>
                            <td ng-if = "checkWrite('invoice')">
                                <a ng-click="invoice.toDeleteId = list.id; invoice.toDeleteTitle = list.invoice_no" data-toggle="modal" data-target="#deleteModal" href>
                                    <i class="fa fa-lg fa-trash-o" aria-hidden="true"></i>
                                </a>
                            </td>
                        </tr>
                        </tbody>

                    </table>
                    <req-pagination itemmeta="meta" itempage="page"></req-pagination>
                </div><!-- /.x_content-->
            </div><!-- /.x_panel-->
        </div>
        <!-- /invoice list -->

        <!-- edit and create column -->
        <div class="col-xs-6">
            <div class="x_panel" ng-hide="invoice.emptyForm">
                <div class="x_title" ng-click="invoice.test()">
                    <h2 ng-show="invoice.editCreate"><i class="fa"></i>ویرایش فاکتور</h2>
                    <h2 ng-hide="invoice.editCreate"><i class="fa"></i>ایجاد فاکتور</h2>
                    <div class="clearfix"></div>
                </div><!-- /.x_title-->
                <div class="x_content">
                    <form name="invoiceForm" role="form"  novalidate>
                        <fieldset ng-disabled ="!checkWrite('invoice')">
                            <div class="box-body">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input type="text" class="form-control" ng-model="invoice.obj.buyer" placeholder="انتخاب خریدار" disabled>
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-primary btn-beside-input" ng-click="invoice.selectBuyer()">انتخاب خریدار</button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input type="text" class="form-control" ng-model="invoice.obj.seller" placeholder="انتخاب فروشنده" disabled>
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-primary btn-beside-input" ng-click="invoice.selectSeller()">انتخاب فروشنده</button>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12">
                                    <div class="form-group" ng-class=" {'has-error' : invoiceForm.invoice_no.$invalid && invoice.obj.invoice_no,
                      'has-success' : invoiceForm.invoice_no.$valid && invoice.obj.invoice_no } ">
                                        <input type="text" class="form-control" name="invoice_no" placeholder="شماره فاکتور" ng-model = "invoice.obj.invoice_no" required>
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group" ng-class="{'has-success' : invoiceForm.datetime.$valid && invoice.obj.datetime}">
                                        <label>تاریخ فاکتور*</label>
                                        <adm-dtp  ng-model="invoice.obj.datetime" ></adm-dtp>
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group" ng-class="{'has-success' : invoiceForm.num_of_products.$valid && invoice.obj.num_of_products}">
                                        <label>تعداد کالا</label>
                                        <input type="number" name="num_of_products" class="form-control" ng-model="invoice.obj.num_of_products" required>
                                    </div>
                                </div>

                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-primary" ng-click="invoice.addProduct()">افزودن کالا</button>
                                            <button type="button" class="btn btn-primary" ng-click="invoice.selectProduct()">انتخاب کالا</button>
                                        </span>
                                    </div>
                                </div>

                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <table class="table table-striped jambo_table asset-tables">
                                            <thead>
                                                <tr>
                                                    <td>نام کالا</td>
                                                    <td>تعداد</td>
                                                    <td>حذف</td>
                                                </tr>
                                            </thead>
                                            <tbody ng-repeat = "product in invoice.obj.products">
                                                <tr>
                                                    <td> {{product.model}} </td>
                                                    <td> {{?}} </td>
                                                    <td ng-if = "checkWrite('invoice')">
                                                        <a ng-click="invoice.toDeleteId = product.id; invoice.toDeleteTitle = product.model" data-toggle="modal" data-target="#deleteModal" href>
                                                            <i class="fa fa-lg fa-trash-o" aria-hidden="true"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <div class="col-xs-12">
                                    <div class="col-xs-4">
                                        <label>تصویر فاکتور</label>
                                    </div>
                                    <div class="col-xs-4">
                                        <div class="btn btn-info btn-sm" ngf-select="invoice.uploadPic()" ng-model="invoice.obj.scanned_invoice" name="file" ngf-pattern="'.jpg,.png,.jpeg,.png'"
                                             ngf-accept="'image/*'" ngf-max-size="2MB" ng-if="!invoice.obj.scanned_invoice && checkWrite('invoice')" ng-required="!invoice.obj.scanned_invoice" ng-disabled="uploading">افزودن تصویر</div>

                                        <button type="button" class="btn btn-sm btn-danger" ng-if="invoice.obj.scanned_invoice && checkWrite('invoice')"
                                                ng-click=" invoice.obj.scanned_invoice = null">حذف تصویر</button>

                                    </div>

                                    <div class="col-xs-4">
                                        <img class="img-responsive img-thumbnail img-sig" ng-src="{{uploadUrl + invoice.obj.scanned_invoice}}"
                                             ng-if="invoice.obj.scanned_invoice">
                                    </div>
                                    <br/>
                                    <p ng-show="invoiceForm.file.$error.maxSize" class="input-error-p">حجم فایل انتخابی بیشتر از ۲ مگابایت است</p>
                                    <p ng-show="invoiceForm.file.$error.pattern" class="input-error-p">فرمت فایل انتخابی مجاز نیست</p>
                                </div>

                                <div class="col-xs-12" style="text-align: left">
                                    <button type="button" class="btn btn-danger" ng-click="invoice.resetInvoiceForm()">لغو</button>
                                    <button type="button" ng-if = "checkWrite('invoice')" ng-disabled="!invoiceForm.$valid" ng-click="invoice.editOrCreate(invoice.editCreate)" class="btn btn-success">ذخیره</button>
                                </div>
                            </div><!-- /.box-body -->
                        </fieldset>
                    </form>
                </div><!-- /.x_content-->
            </div><!-- /.x_panel-->
        </div>
        <!-- /edit and create column -->

    </div>

</div>